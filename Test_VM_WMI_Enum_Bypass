# PowerShell Script to Modify System Properties

# Change Computer Manufacturer and Model
$regPath = "HKLM:\HARDWARE\DESCRIPTION\System\BIOS"
Set-ItemProperty -Path $regPath -Name "Manufacturer" -Value "GenuineIntel"
Set-ItemProperty -Path $regPath -Name "Version" -Value "1.0.0"

# Change Computer System Manufacturer and Model
$regPath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\OEMInformation"
Set-ItemProperty -Path $regPath -Name "Manufacturer" -Value "Dell Inc."
Set-ItemProperty -Path $regPath -Name "Model" -Value "Inspiron 15"

# Modify System Information
$sysInfo = New-Object -ComObject "WinMgmts://./root/cimv2"
$compSys = $sysInfo.ExecQuery("Select * from Win32_ComputerSystem")
foreach ($comp in $compSys) {
    $comp.Model = "Inspiron 15"
    $comp.Manufacturer = "Dell Inc."
    $comp.Put() | Out-Null
}

# Modify BIOS Information
$biosInfo = $sysInfo.ExecQuery("Select * from Win32_BIOS")
foreach ($bios in $biosInfo) {
    $bios.ReleaseDate = "2022-01-01T00:00:00Z"
    $bios.SerialNumber = "1234567890"
    $bios.Put() | Out-Null
}

# Update Network Adapter (Fake Hardware ID)
$networkAdapters = Get-WmiObject -Class Win32_NetworkAdapterConfiguration
foreach ($adapter in $networkAdapters) {
    if ($adapter.Description -like "*Virtual*") {
        # Remove or update virtual network adapters' details
        Set-WmiInstance -Class Win32_NetworkAdapterConfiguration -Arguments @{
            Description = "Intel(R) Ethernet Connection"
        }
    }
}

# Update Disk Controller (Example for VMware or Proxmox)
$diskControllers = Get-WmiObject -Class Win32_IDEController
foreach ($controller in $diskControllers) {
    if ($controller.Description -like "*Virtual*") {
        # Set to a more realistic description
        Set-WmiInstance -Class Win32_IDEController -Arguments @{
            Description = "Standard Dual Channel PCI IDE Controller"
        }
    }
}

# Optional: Hide Virtualization Extensions
$cpuInfo = Get-WmiObject -Class Win32_Processor
foreach ($cpu in $cpuInfo) {
    # Modify CPU characteristics if necessary
}

Write-Output "System properties have been updated."

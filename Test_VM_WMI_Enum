# Define output file
$outputFile = "C:\SystemInfoEnumeration.txt"

# Function to output information
function Write-OutputToFile {
    param (
        [string]$text
    )
    Add-Content -Path $outputFile -Value $text
}

# Clear previous output
Clear-Content -Path $outputFile

# Gather system information

# Computer System Information
Write-OutputToFile "=== Computer System Information ==="
Get-WmiObject -Class Win32_ComputerSystem | Select-Object Manufacturer, Model, TotalPhysicalMemory, NumberOfLogicalProcessors | Format-List | Out-String | Write-OutputToFile

# BIOS Information
Write-OutputToFile "=== BIOS Information ==="
Get-WmiObject -Class Win32_BIOS | Select-Object Manufacturer, ReleaseDate, SerialNumber, Version | Format-List | Out-String | Write-OutputToFile

# Processor Information
Write-OutputToFile "=== Processor Information ==="
Get-WmiObject -Class Win32_Processor | Select-Object Manufacturer, Name, MaxClockSpeed, NumberOfCores, NumberOfLogicalProcessors | Format-List | Out-String | Write-OutputToFile

# Network Adapters
Write-OutputToFile "=== Network Adapters ==="
Get-WmiObject -Class Win32_NetworkAdapterConfiguration | Select-Object Description, MACAddress, ServiceName, PNPDeviceID | Format-List | Out-String | Write-OutputToFile

# Disk Drives
Write-OutputToFile "=== Disk Drives ==="
Get-WmiObject -Class Win32_DiskDrive | Select-Object DeviceID, Model, InterfaceType, Size | Format-List | Out-String | Write-OutputToFile

# IDE Controllers
Write-OutputToFile "=== IDE Controllers ==="
Get-WmiObject -Class Win32_IDEController | Select-Object DeviceID, Manufacturer, Description | Format-List | Out-String | Write-OutputToFile

# System Information from Systeminfo Command
Write-OutputToFile "=== System Information from Systeminfo Command ==="
systeminfo | Out-String | Write-OutputToFile

# Registry Values
Write-OutputToFile "=== Registry Values ==="
$registryPaths = @(
    "HKLM:\HARDWARE\DESCRIPTION\System\BIOS",
    "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\OEMInformation"
)

foreach ($path in $registryPaths) {
    Write-OutputToFile "Registry Path: $path"
    Get-ItemProperty -Path $path | Format-List | Out-String | Write-OutputToFile
}

Write-OutputToFile "=== Completed Enumeration ==="
